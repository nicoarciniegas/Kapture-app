using System.Collections.Generic;
using System.Linq;
using Microsoft.Maui.Controls;

namespace Prodygytek_Kapture_App.Views
{
    public partial class MainPage : ContentPage
    {
        private FormModel selectedForm;
        private User selectedUser;

        public MainPage()
        {
            InitializeComponent();
            FormListView.ItemsSource = GetForms();
            FormListView.ItemSelected += OnFormSelected;
            UserListView.ItemSelected += OnUserSelected;
        }

        public class FormModel
        {
            public required string Name { get; set; }
            public required string HtmlContent { get; set; }
        }

        public class User
        {
            public required string Name { get; set; }
            public required List<FormModel> AssignedForms { get; set; }
        }

        private List<FormModel> GetForms()
        {
            return new List<FormModel>
            {
                new FormModel { Name = "Formulario_1", HtmlContent = "<html><body><h1>Formulario 1</h1></body></html>" },
                new FormModel { Name = "Formulario_2", HtmlContent = "<html><body><h1>Formulario 2</h1></body></html>" },
                new FormModel { Name = "Formulario_Identificación_Ubicación", HtmlContent = "<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>Formulario Identificación y Ubicación</title>\r\n  <style>\r\n    .bg-custom {\r\n      background-color: #DCDCDC;\r\n      border-radius: 10px;\r\n    }\r\n  </style>\r\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"Resources/Raw/bootstrap.min.css\">\r\n</head>\r\n\r\n<body>\r\n  <div class=\"mb-4\">\r\n    <h2>IDENTIFICACION Y UBICACION</h2>\r\n  </div>\r\n\r\n  <form class=\"mx-1\">\r\n    <div class=\"row\">\r\n      <div class=\"container col-lg-6 bg-custom p-3 m-0\">\r\n        <h5 class=\"text-center\">Ubicación geográfica</h5>\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-2 col-sm-12 mb-4\">\r\n            <label for=\"nivel1\" class=\"form-label\">Nivel 1:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"nivel1\" name=\"nivel1\" maxlength=\"2\" required>\r\n          </div>\r\n          <div class=\"col-lg-3 col-sm-12 mb-4\">\r\n            <label for=\"nivel2\" class=\"form-label\">Nivel 2:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"nivel2\" name=\"nivel2\" maxlength=\"3\" required>\r\n          </div>\r\n          <div class=\"col-lg-2 col-sm-12 mb-4\">\r\n            <label for=\"nivel3\" class=\"form-label\">Nivel 3:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"nivel3\" name=\"nivel3\" maxlength=\"1\" required>\r\n          </div>\r\n          <div class=\"col-lg-2 col-sm-12 mb-4\">\r\n            <label for=\"nivel4\" class=\"form-label\">Nivel 4:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"nivel4\" name=\"nivel4\" maxlength=\"2\" required>\r\n          </div>\r\n          <div class=\"col-lg-3 col-sm-12 mb-4\">\r\n            <label for=\"nivel5\" class=\"form-label\">Nivel 5:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"nivel5\" name=\"nivel5\" maxlength=\"3\" required>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-lg-2 col-sm-12 mb-5 mt-5\">\r\n        <label for=\"numeroVivienda\" class=\"form-label\">No. Vivienda:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"numeroVivienda\" name=\"numeroVivienda\" maxlength=\"4\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 col-sm-12 mb-5 mt-lg-5\">\r\n        <label for=\"numeroFamilia\" class=\"form-label\">No. Familia:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"numeroFamilia\" name=\"numeroFamilia\" maxlength=\"4\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 col-sm-12 mb-5 mt-lg-5\">\r\n        <label for=\"sisben\" class=\"form-label\">Nivel SISBEN:</label>\r\n        <select class=\"form-control\" id=\"sisben\" name=\"sisben\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">1</option>\r\n          <option value=\"2\">2</option>\r\n          <option value=\"3\">3</option>\r\n          <option value=\"4\">4</option>\r\n          <option value=\"5\">5</option>\r\n          <option value=\"5\">6</option>\r\n        </select>\r\n      </div>\r\n      <script>\r\n\r\n      </script>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-3 sm-12 mb-4 mt-lg-2\">\r\n        <label for=\"direccion\" class=\"form-label\">Dirección o ubicación de la vivienda:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"direccion\" name=\"direccion\" required>\r\n      </div>\r\n      <div class=\"col-lg-3 sm-12 mb-4 mt-lg-2\">\r\n        <label for=\"nombreBarrio\" class=\"form-label\">Nombre del Barrio/Vereda:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"nombreBarrio\" name=\"nombreBarrio\" required>\r\n      </div>\r\n      <div class=\"col-lg-3 sm-12 mb-4 mt-lg-2\">\r\n        <label for=\"numeroTelefono\" class=\"form-label\">Teléfono:</label>\r\n        <input type=\"tel\" class=\"form-control\" id=\"numeroTelefono\" name=\"numeroTelefono\">\r\n      </div>\r\n      <div class=\"col-lg-3 sm-12 mb-4 mt-lg-2\">\r\n        <label for=\"numeroCelular\" class=\"form-label\">Celular:</label>\r\n        <input type=\"tel\" class=\"form-control\" id=\"numeroCelular\" name=\"numeroCelular\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"text-center mb-2\">\r\n      <button type=\"submit\" class=\"btn btn-primary\">Validar Campos</button>\r\n    </div>\r\n  </form>\r\n\r\n  <script>\r\n    function validarSoloNumeros(input) {\r\n      const regex = /^[0-9]*$/;\r\n      if (!regex.test(input.value)) {\r\n        input.setCustomValidity('Ingrese un número válido');\r\n      } else {\r\n        input.setCustomValidity('');\r\n      }\r\n    }\r\n    document.getElementById(\"nivel1\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"nivel2\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"nivel3\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"nivel4\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"nivel5\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"numeroVivienda\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n    document.getElementById(\"numeroFamilia\").addEventListener(\"input\", function () {\r\n      validarSoloNumeros(this);\r\n    });\r\n\r\n    function validarTelefonoFijo(input) {\r\n      const regex = /^[1-8]\\d{6,7}$/;\r\n      if (!regex.test(input.value)) {\r\n        input.setCustomValidity('Debe empezar con un dígito del 1 al 8 y tener 7 u 8 dígitos en total');\r\n      } else {\r\n        input.setCustomValidity('');\r\n      }\r\n    }\r\n    document.getElementById(\"numeroTelefono\").addEventListener(\"input\", function () {\r\n      validarTelefonoFijo(this);\r\n    });\r\n\r\n    function validarNumeroCelular(input) {\r\n      const regex = /^3\\d{9}$/;\r\n      if (!regex.test(input.value)) {\r\n        input.setCustomValidity(\"El número de celular debe comenzar con 3 y tener 10 dígitos en total\");\r\n      } else {\r\n        input.setCustomValidity(\"\");\r\n      }\r\n    }\r\n    document.getElementById(\"numeroCelular\").addEventListener(\"input\", function () {\r\n      validarNumeroCelular(this);\r\n    });\r\n\r\n    function getFormData() {\r\n      const formElements = document.querySelectorAll(\"input, select, textarea\");\r\n      const formData = {};\r\n      formElements.forEach(element => {\r\n        formData[element.name] = element.value;\r\n      });\r\n      return JSON.stringify(formData);\r\n    }\r\n\r\n    function loadFormData(data) {\r\n      const formData = JSON.parse(data);\r\n      for (const key in formData) {\r\n        if (formData.hasOwnProperty(key)) {\r\n          const element = document.querySelector(`[name=\"${key}\"]`);\r\n          if (element) {\r\n            element.value = formData[key];\r\n          }\r\n        }\r\n      }\r\n    }\r\n  </script>\r\n</body>\r\n</html>\r\n" },
                new FormModel { Name = "Formulario_Familia", HtmlContent = "<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title> Formulario Familia </title>\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"Resources/Raw/bootstrap.min.css\">\r\n</head>\r\n<body>\r\n  <div class=\"mb-4\">\r\n    <h2>PERSONAS DE LA FAMILIA</h2>\r\n  </div>\r\n\r\n  <form class=\"mx-1\">\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"primerNombre\" class=\"form-label\">Primer Nombre:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"primerNombre\" name=\"primerNombre\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"segundoNombre\" class=\"form-label\">Segundo Nombre:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"segundoNombre\" name=\"segundoNombre\">\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"primerApellido\" class=\"form-label\">Primer Apellido:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"primerApellido\" name=\"primerApellido\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"segundoApellido\" class=\"form-label\">Segundo Apellido:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"segundoApellido\" name=\"segundoApellido\">\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"sexo\" class=\"form-label\">Sexo</label>\r\n        <select class=\"form-control\" id=\"sexo\" name=\"sexo\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"M\">Masculino</option>\r\n          <option value=\"F\">Femenino</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"fechaNacimiento\" class=\"form-label\">Fecha de Nacimiento:</label>\r\n        <input type=\"date\" class=\"form-control\" id=\"fechaNacimiento\" name=\"fechaNacimiento\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <script>\r\n      function validarNombreApellido(input) {\r\n        const value = input.value.trim();\r\n        const isValid = Array.from(value).every(char => isNaN(char) && char !== ' ');\r\n\r\n        if (!isValid) {\r\n          input.setCustomValidity(\"Solo se permiten letras\");\r\n        } else {\r\n          input.setCustomValidity(\"\");\r\n        }\r\n      }\r\n\r\n      document.getElementById(\"primerNombre\").addEventListener(\"keyup\", function () {\r\n        validarNombreApellido(this);\r\n      });\r\n      document.getElementById(\"segundoNombre\").addEventListener(\"input\", function () {\r\n        validarNombreApellido(this);\r\n      });\r\n      document.getElementById(\"primerApellido\").addEventListener(\"input\", function () {\r\n        validarNombreApellido(this);\r\n      });\r\n      document.getElementById(\"segundoApellido\").addEventListener(\"input\", function () {\r\n        validarNombreApellido(this);\r\n      });\r\n\r\n      function calcularEdad(fechaNacimiento) {\r\n      const nacimiento = moment(fechaNacimiento);\r\n      const hoy = moment();\r\n      const edadA = hoy.diff(nacimiento, 'years');\r\n      const edadM = hoy.diff(nacimiento, 'months') % 12;\r\n      const edadD = hoy.diff(nacimiento, 'days') % 30;\r\n\r\n      console.log(edadA, edadM, edadD);\r\n      return { años: edadA, meses: edadM, dias: edadD };\r\n      }\r\n\r\n      document.getElementById(\"fechaNacimiento\").addEventListener(\"change\", function () {\r\n      const fechaNacimiento = this.value;\r\n      const hoy = new Date();\r\n      const nacimiento = new Date(fechaNacimiento);\r\n\r\n      if (nacimiento > hoy) {\r\n        this.setCustomValidity(\"La fecha de nacimiento no puede ser mayor a la fecha actual\");\r\n      } else {\r\n        this.setCustomValidity(\"\");\r\n        const edad = calcularEdad(fechaNacimiento);\r\n\r\n        if (edad.años > 0) {\r\n          document.getElementById(\"edadCantidad\").value = edad.años;\r\n          document.getElementById(\"edadUnidad\").value = \"A\";\r\n        } else if (edad.meses > 0) {\r\n          document.getElementById(\"edadCantidad\").value = edad.meses;\r\n          document.getElementById(\"edadUnidad\").value = \"M\";\r\n        } else {\r\n          document.getElementById(\"edadCantidad\").value = edad.dias;\r\n          document.getElementById(\"edadUnidad\").value = \"D\";\r\n        }\r\n      }\r\n    });\r\n\r\n    </script>\r\n\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-1 sm-12 mb-5\">\r\n        <label for=\"edadCantidad\" class=\"form-label\">Edad:</label>\r\n        <input type=\"number\" class=\"form-control\" id=\"edadCantidad\" name=\"edadCantidad\" disabled>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"edadUnidad\" class=\"form-label\">Unidad de Edad:</label>\r\n        <select class=\"form-control\" id=\"edadUnidad\" name=\"edadUnidad\" disabled>\r\n          <option value=\"\"></option>\r\n          <option value=\"A\">Años</option>\r\n          <option value=\"M\">Meses</option>\r\n          <option value=\"D\">Días</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"parentesco\" class=\"form-label\">Parentesco:</label>\r\n        <select class=\"form-control\" id=\"parentesco\" name=\"parentesco\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"1\">Jefe(a) de familia</option>\r\n          <option value=\"2\">Cónyuge o compañero</option>\r\n          <option value=\"3\">Hijo(a)</option>\r\n          <option value=\"4\">Otros parientes</option>\r\n          <option value=\"5\">Otros miembros no parientes</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"tipoDocumento\" class=\"form-label\">Tipo de Documento:</label>\r\n        <select class=\"form-control\" id=\"tipoDocumento\" name=\"tipoDocumento\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"CC\">Cédula de Ciudadania</option>\r\n          <option value=\"CE\">Cédula de Extranjería</option>\r\n          <option value=\"PA\">Pasaporte</option>\r\n          <option value=\"RC\">Registro Civil</option>\r\n          <option value=\"TI\">Tarjeta de Identidad</option>\r\n          <option value=\"AS\">Adulto sin identificación</option>\r\n          <option value=\"MS\">Menor sin identificación</option>\r\n          <option value=\"NV\">Certificado de nacido vivo en menores de 2 meses</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"numeroDocumento\" class=\"form-label\">Número de Documento:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"numeroDocumento\" name=\"numeroDocumento\">\r\n      </div>\r\n      <div class=\"col-lg-1 sm-12 mb-5\">\r\n        <label for=\"escolaridad\" class=\"form-label\">Escolaridad:</label>\r\n        <select class=\"form-control\" id=\"escolaridad\" name=\"escolaridad\" required onchange=\"actualizarGrados()\">\r\n            <option value=\"\">Seleccione una opción</option>\r\n            <option value=\"Si\">Sí</option>\r\n            <option value=\"No\">No</option>\r\n        </select>\r\n    </div>\r\n    \r\n    <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"gradoAprobado\" class=\"form-label\">Último Grado Aprobado:</label>\r\n        <select class=\"form-control\" id=\"gradoAprobado\" name=\"gradoAprobado\" required>\r\n        </select>\r\n    </div>\r\n    \r\n    </div>\r\n\r\n    <script>\r\n\r\n      function esNumerico(valor) {\r\n        return Array.from(valor).every(char => !isNaN(char));\r\n      }\r\n\r\n      function esAlfanumerico(valor) {\r\n        return Array.from(valor).every(char => {\r\n          const charCode = char.charCodeAt(0);\r\n          return (charCode >= 48 && charCode <= 57) || // 0-9\r\n            (charCode >= 65 && charCode <= 90) || // A-Z\r\n            (charCode >= 97 && charCode <= 122);  // a-z\r\n        });\r\n      }\r\n\r\n      function validarNumeroDocumento() {\r\n        const tipoDocumento = document.getElementById(\"tipoDocumento\").value;\r\n        const numeroDocumento = document.getElementById(\"numeroDocumento\");\r\n        const valor = numeroDocumento.value;\r\n\r\n        numeroDocumento.setCustomValidity(\"\");\r\n\r\n        switch (tipoDocumento) {\r\n          case \"CC\":\r\n            if (!valor || !esNumerico(valor) || valor.startsWith(\"0\") || valor.length < 6 || valor.length > 10) {\r\n              numeroDocumento.setCustomValidity(\"La Cédula de Ciudadania debe ser un número de 6 a 10 dígitos y no puede empezar con 0\");\r\n            }\r\n            break;\r\n          case \"CE\":\r\n            if (!valor || !esNumerico(valor) || valor.startsWith(\"0\")) {\r\n              numeroDocumento.setCustomValidity(\"La Cédula de Extranjería debe ser un número y no puede empezar con 0\");\r\n            }\r\n            break;\r\n          case \"PA\":\r\n            if (!valor || !esAlfanumerico(valor)) {\r\n              numeroDocumento.setCustomValidity(\"El Pasaporte debe ser alfanumérico\");\r\n            }\r\n            break;\r\n          case \"RC\":\r\n            if (!valor || !esAlfanumerico(valor) || valor.length < 10 || valor.length > 11) {\r\n              numeroDocumento.setCustomValidity(\"El Registro Civil debe ser alfanumérico de 10 a 11 caracteres\");\r\n            }\r\n            break;\r\n          case \"TI\":\r\n            if (!valor || !esNumerico(valor) || valor.startsWith(\"0\") || valor.length !== 10) {\r\n              numeroDocumento.setCustomValidity(\"La Tarjeta de Identidad debe ser un número de 10 dígitos y no puede empezar con 0\");\r\n            }\r\n            break;\r\n          case \"AS\":\r\n          case \"MS\":\r\n            // No necesita validacion\r\n            break;\r\n          case \"NV\":\r\n            if (!valor || !esNumerico(valor)) {\r\n              numeroDocumento.setCustomValidity(\"El Certificado de nacido vivo debe ser numérico\");\r\n            }\r\n            break;\r\n          default:\r\n            numeroDocumento.setCustomValidity(\"Seleccione un tipo de documento válido\");\r\n        }\r\n      }\r\n\r\n      document.getElementById(\"tipoDocumento\").addEventListener(\"change\", validarNumeroDocumento);\r\n      document.getElementById(\"numeroDocumento\").addEventListener(\"input\", validarNumeroDocumento);\r\n\r\n      function actualizarGrados() {\r\n        var escolaridad = document.getElementById(\"escolaridad\").value;\r\n        var gradoSelect = document.getElementById(\"gradoAprobado\");\r\n\r\n        // Limpiar opciones anteriores\r\n        gradoSelect.innerHTML = \"\";\r\n\r\n        if (escolaridad === \"Si\") {\r\n          // Opciones cuando el usuario SÍ fue a la escuela\r\n          var opciones = [\r\n            { valor: \"-2\", texto: \"No aplica por edad (menor de 5 años)\" },\r\n            { valor: \"-1\", texto: \"No recuerda el grado\" },\r\n            { valor: \"0\", texto: \"Preescolar\" },\r\n            { valor: \"1\", texto: \"1er Grado\" },\r\n            { valor: \"2\", texto: \"2do Grado\" },\r\n            { valor: \"3\", texto: \"3er Grado\" },\r\n            { valor: \"4\", texto: \"4to Grado\" },\r\n            { valor: \"5\", texto: \"5to Grado\" },\r\n            { valor: \"6\", texto: \"6to Grado\" },\r\n            { valor: \"7\", texto: \"7mo Grado\" },\r\n            { valor: \"8\", texto: \"8vo Grado\" },\r\n            { valor: \"9\", texto: \"9no Grado\" },\r\n            { valor: \"10\", texto: \"10mo Grado\" },\r\n            { valor: \"11\", texto: \"11vo Grado\" }\r\n          ];\r\n\r\n        } else if (escolaridad === \"No\") {\r\n          // Opciones cuando el usuario NO fue a la escuela\r\n          var opciones = [\r\n            { valor: \"0\", texto: \"No sabe leer ni escribir\" },\r\n            { valor: \"-1\", texto: \"No recuerda el grado\" },\r\n            { valor: \"-2\", texto: \"No fue a escuela pero lee y escribe\" },\r\n            { valor: \"1\", texto: \"1er Grado\" },\r\n            { valor: \"2\", texto: \"2do Grado\" },\r\n            { valor: \"3\", texto: \"3er Grado\" },\r\n            { valor: \"4\", texto: \"4to Grado\" },\r\n            { valor: \"5\", texto: \"5to Grado\" },\r\n            { valor: \"6\", texto: \"6to Grado\" },\r\n            { valor: \"7\", texto: \"7mo Grado\" },\r\n            { valor: \"8\", texto: \"8vo Grado\" },\r\n            { valor: \"9\", texto: \"9no Grado\" },\r\n            { valor: \"10\", texto: \"10mo Grado\" },\r\n            { valor: \"11\", texto: \"11vo Grado\" }\r\n          ];\r\n        }\r\n\r\n        opciones.forEach(function (opcion) {\r\n          var opt = document.createElement(\"option\");\r\n          opt.value = opcion.valor;\r\n          opt.textContent = opcion.texto;\r\n          gradoSelect.appendChild(opt);\r\n        });\r\n      }\r\n\r\n    </script>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"ocupacionIngreso\" class=\"form-label\">Ocupación Ingreso:</label>\r\n        <select class=\"form-control\" id=\"ocupacionIngreso\" name=\"ocupacionIngreso\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"1\">Trabajando</option>\r\n          <option value=\"2\">Buscando Trabajo</option>\r\n          <option value=\"3\">Estudiando</option>\r\n          <option value=\"4\">Oficios del hogar</option>\r\n          <option value=\"5\">Rentista</option>\r\n          <option value=\"6\">Jubilado, pensionado</option>\r\n          <option value=\"7\">No aplica por edad (&lt;6 años)</option>\r\n          <option value=\"8\">Sin ocupación</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"actividadEconomica\" class=\"form-label\">Actividad Económica:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"actividadEconomica\" name=\"actividadEconomica\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"SGSSS\" class=\"form-label\">Tipo de S.G.S.S.S.:</label>\r\n        <select class=\"form-control\" id=\"SGSSS\" name=\"SGSSS\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"C\">Contributivo</option>\r\n          <option value=\"S\">Subsidiado</option>\r\n          <option value=\"V\">Vinculado</option>\r\n          <option value=\"P\">Particular</option>\r\n          <option value=\"E\">R. Especiales</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"codigoInstitucion\" class=\"form-label\">Código Institución:</label>\r\n        <input type=\"text\" class=\"form-control\" id=\"codigoInstitucion\" name=\"codigoInstitucion\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"tipoAfiliado\" class=\"form-label\">Tipo Afiliado:</label>\r\n        <select class=\"form-control\" id=\"tipoAfiliado\" name=\"tipoAfiliado\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"C\">Cotizante</option>\r\n          <option value=\"B\">Beneficiario</option>\r\n          <option value=\"A\">Adicional</option>\r\n          <option value=\"N\">No Aplica</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"grupoEtnico\" class=\"form-label\">Grupo Étnico:</label>\r\n        <select class=\"form-control\" id=\"grupoEtnico\" name=\"grupoEtnico\" required>\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"1\">Indígena</option>\r\n          <option value=\"2\">ROM (Gitano)</option>\r\n          <option value=\"3\">Raizal (Archipiélago de San Andrés y Providencia)</option>\r\n          <option value=\"4\">Palanquero de San Basilio</option>\r\n          <option value=\"5\">Negro(a), Mulato(a), Afrocolombiano(a) ó Afrodescendiente</option>\r\n          <option value=\"6\">Ninguno de los anteriores</option>\r\n        </select>\r\n      </div>\r\n      <script>\r\n        function validarActividadEconomica(input) {\r\n          const value = input.value.trim();\r\n          const isValid = Array.from(value).every(char => isNaN(char) && char !== ' ');\r\n\r\n          if (!isValid || value === \"\") {\r\n            input.setCustomValidity(\"Solo se permiten letras y no puede estar vacío\");\r\n          } else {\r\n            input.setCustomValidity(\"\");\r\n          }\r\n        }\r\n\r\n        document.getElementById(\"actividadEconomica\").addEventListener(\"input\", function () {\r\n          validarActividadEconomica(this);\r\n        });\r\n      </script>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-3 sm-12 mb-5\">\r\n        <label for=\"edadTabaco\" class=\"form-label\">Edad Inicio Consumo de Tabaco:</label>\r\n        <input type=\"number\" class=\"form-control\" id=\"edadTabaco\" name=\"edadTabaco\"\r\n          placeholder=\"Si no consume, coloque 0\" required>\r\n      </div>\r\n      <div class=\"col-lg-3 sm-12 mb-5\">\r\n        <label for=\"edadAlcohol\" class=\"form-label\">Edad Inicio Consumo de Alcohol:</label>\r\n        <input type=\"number\" class=\"form-control\" id=\"edadAlcohol\" name=\"edadAlcohol\"\r\n          placeholder=\"Si no consume, coloque 0\" required>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"condicionEspecial\" class=\"form-label\">Condición Especial:</label>\r\n        <select class=\"form-control\" id=\"condicionEspecial\" name=\"condicionEspecial\">\r\n          <option value=\"\">Seleccione una opción</option>\r\n          <option value=\"1\">Detenido</option>\r\n          <option value=\"2\">Desaparecido</option>\r\n          <option value=\"3\">Habitante de la calle</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"numeroCelular\" class=\"form-label\">Celular:</label>\r\n        <input type=\"tel\" class=\"form-control\" id=\"numeroCelular\" name=\"numeroCelular\">\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"correoElectronico\" class=\"form-label\">Correo Electrónico:</label>\r\n        <input type=\"email\" class=\"form-control\" id=\"correoElectronico\" name=\"correoElectronico\">\r\n      </div>\r\n      <script>\r\n        function validarEdadConsumo(input) {\r\n          const edad = parseInt(input.value, 10);\r\n          if (edad < 0) {\r\n            input.setCustomValidity(\"Ingrese una edad válida\");\r\n          } else {\r\n            input.setCustomValidity(\"\");\r\n          }\r\n        }\r\n        document.getElementById(\"edadTabaco\").addEventListener(\"input\", function () {\r\n          validarEdadConsumo(this);\r\n        });\r\n        document.getElementById(\"edadAlcohol\").addEventListener(\"input\", function () {\r\n          validarEdadConsumo(this);\r\n        });\r\n\r\n        function validarNumeroCelular(input) {\r\n          const regex = /^3\\d{9}$/;\r\n          if (!regex.test(input.value)) {\r\n            input.setCustomValidity(\"El número de celular debe comenzar con 3 y tener 10 dígitos en total\");\r\n          } else {\r\n            input.setCustomValidity(\"\");\r\n          }\r\n        }\r\n        document.getElementById(\"numeroCelular\").addEventListener(\"input\", function () {\r\n          validarNumeroCelular(this);\r\n        });\r\n\r\n      </script>\r\n    </div>\r\n\r\n    <div class=\"text-center mb-2\">\r\n      <button type=\"submit\" class=\"btn btn-primary\">Validar Campos</button>\r\n    </div>\r\n    <script>\r\n      function getFormData() {\r\n        const formElements = document.querySelectorAll(\"input, select\");\r\n        const formData = {};\r\n        formElements.forEach(element => {\r\n          formData[element.name] = element.value;\r\n        });\r\n        return JSON.stringify(formData);\r\n      }\r\n\r\n      function loadFormData(data) {\r\n        const formData = JSON.parse(data);\r\n\r\n        for (const key in formData) {\r\n          if (formData.hasOwnProperty(key)) {\r\n            const element = document.querySelector(`[name=\"${key}\"]`);\r\n\r\n            if (element) {\r\n              // Si es el select de escolaridad, primero se asigna y se actualiza grados\r\n              if (key === \"escolaridad\") {\r\n                element.value = formData[key];\r\n                actualizarGrados(); // Generar opciones antes de asignar gradoAprobado\r\n              } else {\r\n                element.value = formData[key];\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        // Esperar para asignar gradoAprobado después de que actualizarGrados() lo llene\r\n        setTimeout(() => {\r\n          if (formData.gradoAprobado) {\r\n            document.getElementById(\"gradoAprobado\").value = formData.gradoAprobado;\r\n          }\r\n        }, 100);\r\n      }\r\n\r\n      function sendHeightToMAUI() {\r\n        var height = document.body.scrollHeight;\r\n        console.log(height);\r\n      }\r\n        \r\n\r\n    </script>\r\n\r\n  </form>\r\n\r\n</body>\r\n</html>" },
                new FormModel { Name = "Formulario_Vivienda", HtmlContent = "<!DOCTYPE html>\r\n<html lang=\"es\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title> Formulario Vivienda </title>\r\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"Resources/Raw/bootstrap.min.css\">\r\n</head>\r\n\r\n<body>\r\n  <div class=\"mb-4\">\r\n    <h2> Formulario Vivienda </h2>\r\n  </div>\r\n\r\n  <form class=\"mx-1\" id=\"formularioVivienda\">\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"tipoVivienda\" class=\"form-label\">Tipo Vivienda:</label>\r\n        <select class=\"form-control\" id=\"tipoVivienda\" name=\"tipoVivienda\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Casa, apartamento</option>\r\n          <option value=\"2\">Cuarto(s)</option>\r\n          <option value=\"3\">otros</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"tenencia\" class=\"form-label\">Tenencia:</label>\r\n        <select class=\"form-control\" id=\"tenencia\" name=\"tenencia\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Propia</option>\r\n          <option value=\"2\">En arriendo</option>\r\n          <option value=\"3\">Otra</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"servicioSanitario\" class=\"form-label\">Servicio Sanitario:</label>\r\n        <select class=\"form-control\" id=\"servicioSanitario\" name=\"servicioSanitario\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">No tiene servicio sanitario</option>\r\n          <option value=\"2\">Letrina</option>\r\n          <option value=\"3\">Inodoro sin conexión a alcantarillado o pozo séptico</option>\r\n          <option value=\"4\">Inodoro conectado a pozo séptico</option>\r\n          <option value=\"5\">Inodoro conectado a alcantarillado</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"alumbrado\" class=\"form-label\">Tipo Alumbrado:</label>\r\n        <select class=\"form-control\" id=\"alumbrado\" name=\"alumbrado\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Vela u Otro</option>\r\n          <option value=\"2\">Kerosene, petroleo, gasolina</option>\r\n          <option value=\"3\">Eléctrico</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"disposicionBasura\" class=\"form-label\">La basura es:</label>\r\n        <select class=\"form-control\" id=\"disposicionBasura\" name=\"disposicionBasura\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Recogida en domicilio</option>\r\n          <option value=\"2\">La quema, la bota ó la entierra</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"recicladoBasura\" class=\"form-label\">¿Se reciclan las basuras?</label>\r\n        <select class=\"form-control\" id=\"recicladoBasura\" name=\"recicladoBasura\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Si\">Si</option>\r\n        </select>\r\n      </div>\r\n\r\n      \r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"humo\" class=\"form-label\">¿Humo dentro de la vivienda?</label>\r\n        <select class=\"form-control\" id=\"humo\" name=\"humo\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Si\">Si</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"col-lg-3 sm-12 mb-5\">\r\n        <label for=\"aguaAcueducto\" class=\"form-label\">¿El agua para consumo humano de su casa proviene de acueducto?</label>\r\n        <select class=\"form-control\" id=\"aguaAcueducto\" name=\"aguaAcueducto\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Si\">Si</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"aguaTratamiento\" class=\"form-label\">Tipo de tratamiento casero del agua:</label>\r\n        <select class=\"form-control\" id=\"aguaTratamiento\" name=\"aguaTratamiento\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Sin tratamiento</option>\r\n          <option value=\"2\">Clorada</option>\r\n          <option value=\"3\">Filtrada</option>\r\n          <option value=\"4\">Hervida</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"col-lg-2 sm-12 mb-5\">\r\n        <label for=\"aguaTratamientoFuente\" class=\"form-label\">Tratamiento del Agua en la Fuente:</label>\r\n        <select class=\"form-control\" id=\"aguaTratamientoFuente\" name=\"aguaTratamientoFuente\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Si\">Si</option>\r\n          <option value=\"No sabe\">No sabe</option>\r\n        </select>\r\n        <small class=\"form-text text-muted\">La respuesta la asigna el Agente Comunitario</small>\r\n      </div>\r\n\r\n      <div class=\"col-lg-3 sm-12 mb-5\">\r\n        <label for=\"personasHabitacion\" class=\"form-label\">¿Duermen mas de 3 personas en una habitación?</label>\r\n        <select class=\"form-control\" id=\"personasHabitacion\" name=\"personasHabitacion\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Si\">Si</option>\r\n        </select>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-12 sm-12 mb-5\">\r\n        <table class=\"table table-bordered\" id=\"animalesVivienda\">\r\n          <thead class=\"thead-light\">\r\n            <tr>\r\n              <th>Animales en la vivienda</th>\r\n              <th>¿Cuántos?</th>\r\n              <th class=\"bg-success text-white\">¿Cuántos vacunados último año?</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Gatos</td>\r\n              <td><input type=\"number\" name=\"gatos_cantidad\" id=\"gatos_cantidad\" min=\"0\" class=\"form-control\" required></td>\r\n              <td><input type=\"number\" name=\"gatos_vacunados\" id=\"gatos_vacunados\" min=\"0\" class=\"form-control\" required></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Perros</td>\r\n              <td><input type=\"number\" name=\"perros_cantidad\" id=\"perros_cantidad\" min=\"0\" class=\"form-control\" required></td>\r\n              <td><input type=\"number\" name=\"perros_vacunados\" id=\"perros_vacunados\" min=\"0\" class=\"form-control\" required></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Otros (¿Cuál?)</td>\r\n              <td>\r\n                <input type=\"text\" name=\"otros_especificar\" id=\"otros_especificar\" placeholder=\"Especifica\" class=\"form-control mb-3\">\r\n                <input type=\"number\" name=\"otros_cantidad\" id=\"otros_cantidad\" min=\"1\" class=\"form-control\">\r\n              </td>\r\n              <td><input type=\"number\" name=\"otros_vacunados\" id=\"otros_vacunados\" min=\"1\" class=\"form-control\"></td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <script>\r\n        document.addEventListener('DOMContentLoaded', function () {\r\n        var otrosEspecificar = document.getElementById('otros_especificar');\r\n        \r\n        if (otrosEspecificar) {\r\n          otrosEspecificar.addEventListener('input', function () {\r\n            var otrosCantidad = document.getElementById('otros_cantidad');\r\n            var otrosVacunados = document.getElementById('otros_vacunados');\r\n            if (this.value.trim() !== '') {\r\n              otrosCantidad.setAttribute('required', 'required');\r\n              otrosVacunados.setAttribute('required', 'required');\r\n            } else {\r\n              otrosCantidad.removeAttribute('required');\r\n              otrosVacunados.removeAttribute('required');\r\n            }\r\n\r\n            const isValid = Array.from(this.value).every(char => isNaN(char) && char !== ' ');\r\n            if (!isValid) {\r\n              this.setCustomValidity(\"Solo se permiten letras\");\r\n            } else {\r\n              this.setCustomValidity(\"\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n      </script>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\" col-lg-12 sm-12 mb-5\">\r\n        <table class=\"table table-bordered\" id=\"enfermedadesVivienda\">\r\n          <thead>\r\n            <tr>\r\n              <th class=\"text-center bg-light\">Observe en el entorno (100 m) de la vivienda si hay</th>\r\n              <th class=\"text-center bg-success text-white\">Sí</th>\r\n              <th class=\"text-center bg-success text-white\">No</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Basurero</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"basurero\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"basurero\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Matadero</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"matadero\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"matadero\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Desembocadura de cañería</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"desembocadura\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"desembocadura\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Río</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"rio\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"rio\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Caño</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"cano\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"cano\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Laderas de montaña o cerro</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"montana\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"montana\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Ladera de volcán</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"volcan\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"volcan\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Cárcel</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"carcel\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"carcel\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Puesto de policía o base militar</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"policia\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"policia\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\" sm-12 mb-5\">\r\n        <table class=\"table table-bordered\" id=\"observacionesVivienda\">\r\n          <thead>\r\n            <tr>\r\n              <th class=\"text-center bg-light\">Observe en la vivienda si hay</th>\r\n              <th class=\"text-center bg-success text-white\">Sí</th>\r\n              <th class=\"text-center bg-success text-white\">No</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Iluminación adecuada</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"iluminacion\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"iluminacion\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Ventilación adecuada</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"ventilacion\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"ventilacion\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Gas natural conectado a red pública</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"gas_natural\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"gas_natural\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Lugar destinado solo para cocina</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"cocina\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"cocina\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Anejos en puertas y ventanas</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"anejos\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"anejos\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Roedores</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"roedores\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"roedores\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td>Reservorios de agua</td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"reservorios\" value=\"Si\" required>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <input type=\"radio\" name=\"reservorios\" value=\"No\">\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-lg-4 sm-12 mb-5\">\r\n        <label for=\"materialPiso\" class=\"form-label\">Material predominante en el piso:</label>\r\n        <select class=\"form-control\" id=\"materialPiso\" name=\"materialPiso\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Tierra</option>\r\n          <option value=\"2\">Madera burda, tabla, tablón</option>\r\n          <option value=\"3\">Cemento</option>\r\n          <option value=\"4\">Baldosa-vinilo-tableta ó ladrillo</option>\r\n          <option value=\"5\">Alfombra ó tapete de pared a pared</option>\r\n          <option value=\"6\">Mármol-parqué ó madera pulida</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"col-lg-4 sm-12 mb-5\">\r\n        <label for=\"materialTecho\" class=\"form-label\">Material predominante en el techo:</label>\r\n        <select class=\"form-control\" id=\"materialTecho\" name=\"materialTecho\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Desechos: cartón-lata-sacos-etc</option>\r\n          <option value=\"2\">Paja ó palma</option>\r\n          <option value=\"3\">Teja de barro-zinc-cemento sin cielo raso</option>\r\n          <option value=\"4\">Losa ó plancha-teja de barro-zinc-asbesto-cemento con cielo raso</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"col-lg-4 sm-12 mb-5\">\r\n        <label for=\"materialParedes\" class=\"form-label\">Material predominante en las paredes:</label>\r\n        <select class=\"form-control\" id=\"materialParedes\" name=\"materialParedes\" required>\r\n          <option value=\"\">Seleccione</option>\r\n          <option value=\"1\">Vivienda sin paredes</option>\r\n          <option value=\"2\">Zinc, plástico, tela, cartón, latas ó desechos</option>\r\n          <option value=\"3\">Guadua, caña, esterilla</option>\r\n          <option value=\"4\">Madera burda</option>\r\n          <option value=\"5\">Bahareque</option>\r\n          <option value=\"6\">Tapia pisada ó adobe</option>\r\n          <option value=\"7\">Bloque-ladrillo-piedra ó material prefabricado-madera pulida</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"text-center mb-2\">\r\n      <button type=\"submit\" class=\"btn btn-primary\">Validar Campos</button>\r\n    </div>\r\n\r\n    <script>\r\n      function sendHeightToMAUI() {\r\n        var height = document.body.scrollHeight;\r\n        window.external.notify(height.toString());\r\n      }\r\n\r\n        window.onload = sendHeightToMAUI;\r\n    \r\n      function getFormData() {\r\n        const formElements = document.querySelectorAll(\"input, select, textarea\");\r\n        const formData = {};\r\n        formElements.forEach(element => {\r\n          if (element.type === 'radio') {\r\n            if (element.checked) {\r\n              formData[element.name] = element.value;\r\n            }\r\n          } else {\r\n            formData[element.name] = element.value;\r\n          }\r\n        });\r\n        return JSON.stringify(formData);\r\n      }\r\n\r\n      function loadFormData(data) {\r\n        const formData = JSON.parse(data);\r\n        for (const key in formData) {\r\n          if (formData.hasOwnProperty(key)) {\r\n            const element = document.querySelector(`[name=\"${key}\"]`);\r\n            if (element) {\r\n              if (element.type === 'radio') {\r\n                const radioElement = document.querySelector(`[name=\"${key}\"][value=\"${formData[key]}\"]`);\r\n                if (radioElement) {\r\n                  radioElement.checked = true;\r\n                }\r\n              } else {\r\n                element.value = formData[key];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n  </script>\r\n    \r\n  </form>\r\n</body>\r\n</html>" },
                new FormModel { Name = "Formulario_6", HtmlContent = "<html><body><h1>Formulario 6</h1></body></html>" },
                new FormModel { Name = "Formulario_7", HtmlContent = "<html><body><h1>Formulario 7</h1></body></html>" },
                new FormModel { Name = "Formulario_8", HtmlContent = "<html><body><h1>Formulario 8</h1></body></html>" },
                new FormModel { Name = "Formulario_9", HtmlContent = "<html><body><h1>Formulario 9</h1></body></html>" }
            };
        }

        private List<User> GetUsers()
        {
            var forms = GetForms();
            return new List<User>
            {
                new User { Name = "Nicolas", AssignedForms = new List<FormModel> { forms[2], forms[4] } },
                new User { Name = "Omaira", AssignedForms = new List<FormModel> { forms[2], forms[3] } },
                new User { Name = "Guiovanni", AssignedForms = new List<FormModel> { forms[3], forms[4] } }
            };
        }

        private void OnFormSelected(object sender, SelectedItemChangedEventArgs e)
        {
            if (e.SelectedItem is FormModel form)
            {
                selectedForm = form;
                var users = GetUsers().Where(user => user.AssignedForms.Any(f => f.Name == form.Name)).ToList();
                UserListView.ItemsSource = users;
            }
        }

        private void OnUserSelected(object sender, SelectedItemChangedEventArgs e)
        {
            if (e.SelectedItem is User user)
            {
                selectedUser = user;
                
            }
        }

        private async void OnNavigateButtonClicked(object sender, EventArgs e)
        {
            if (selectedForm != null && selectedUser != null)
            {
                var navigationParameter = new Dictionary<string, object>
                {
                    { "HtmlContent", selectedForm.HtmlContent },
                    { "formName", selectedForm.Name },
                    { "selectedUser", selectedUser.Name }
                };
                await Shell.Current.GoToAsync("//forms", navigationParameter);
            }
            else
            {
                await DisplayAlert("Advertencia!!", "Por favor, seleccione un formulario y un usuario antes de continuar", "OK");
            }
        }
    }
}
